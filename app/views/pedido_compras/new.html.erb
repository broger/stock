  <div class="row" >
     <div id="titulo" class="col-sm-12" >
         <h2 style="margin:0">Nuevo Pedido Compra</h2>
         <hr style=" width=100%; border-width: 1px 0 0 0; margin:0; border-color:#333333; ">
     </div>
     <div id="menu_izquierdo"  class="col-sm-2" >

       <!-- ACORDENON -->
       <div class="panel-group" id="accordion">
           <div class="panel panel-default">
             <div class="panel-heading">
                  <h5 class="panel-title"><a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Registros</a></h5>
             </div>
             <div id="collapseOne" class="panel-collapse collapse in">
             </div>
        </div>
           <div class="panel panel-default">
             <div class="panel-heading" style="background-color:#2197C9">
              <h5 class="panel-title" style="background-color:#2197C9" ><a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">Reportes</a></h5>
             </div>
             <div id="collapseTwo" class="panel-collapse collapse">
              <div class="panel-body"> - Todos   </div>
             </div>
           </div>
           <div class="panel panel-default">
              <div class="panel-heading">
                <h4 class="panel-title">
                  <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
                    Tablas Relacionadas
                  </a>
                </h4>
              </div>
              <div id="collapseThree" class="panel-collapse collapse">
                <div class="panel-body">
                 - Compras
                 - Productos
                 
                </div>
              </div>
            </div>
      </div>


     </div>
     <div  id="contenido"  class="col-sm-10" >
     	<% form_for(@comprobante) do |f| %>
        <%= f.error_messages %>
	    <div id="comprobante" class= "col-sm-12" >
     		<div id="cabezera">
     			  <div class= "datos" id= "nro_comprobante"  style="width:170px"><th><%= f.label :numero, "NÂº:" %></th><%= f.text_field :numero,  :value=> '0001', :style=>'width:140px' , :class=> 'form-control'%></div>
     			  <div class= "datos" id= "proveedor"        style="width:350px" ><%= f.label :proveedor %><%= select_tag :proveedor_id, options_from_collection_for_select(Proveedor.all, :id, :nombre) , :style=>'width:240px', :class=>'default select' %></div>
		        <div class= "datos"                        style="width:280px">
                 <%#= button_tag 'addprod', 'sin_stock', true,  :value => 'sin_stock' %><%#= label_tag 'addprod_sin_stock', 'agregar productos sin stock'%>
                 <%#= button_tag 'addprod', 'todos',     false, :value => 'todos'     %><%#= label_tag 'addprod_todos',     'todos'%>
                 <button type="button" class="btn btn-default btn-xs"  onClick="agregar_ajax('sin_stock')" style="font-size:10px" title="Agregar productos sin stock del proveedor seleccionado"><i class="glyphicon glyphicon-arrow-down"></i>productos sin stock</button>
                 <button type="button" class="btn btn-default btn-xs"  onClick="agregar_ajax('todos')" style="font-size:10px" title="Agregar todos los productos del proveedor seleccionado"><i class="glyphicon glyphicon-arrow-down"></i>todos los productos</button>
            </div>                                                                         
            <div class= "datos" style="width:100px"><%=Time.now.strftime("%d/%m/%Y") %></div>
            

          <!--  
            <div class= "datos" id= "observaciones" style="display:block"><%= "Observaciones #{ f.text_field :observaciones , :size=> 20}" %></div>
            <div class= "datos" id= "deposito" ><%= "Deposito #{select_tag :deposito_id, options_from_collection_for_select(Deposito.all, :id, :nombre) }  "%></div>      
            -->
			  </div>	
         <div id="busca_productos">
          <%= text_field_tag :producto, nil, :style=> "width:70%", :placeholder => ' Ingrese el nombre del Producto ...'%>
          <%= text_field_tag :cantidad, nil, :class =>'producto', :style=> "width:10%", :placeholder => ' cantidad ...' %>
          <a  style ="font-size:16px; width:50px" class="btn btn-primary glyphicon glyphicon-plus-sign" onClick="agregar_ajax('uno_solo')" ></a>           
          <%= hidden_field_tag :producto_id, nil, :id=>"producto_id" %>
          <%= hidden_field_tag :agrega, nil, :id=>"agrega" %>     
         <div id="detalle">
         		<div  class="scroll" sytle ="width:100%; height:300px">
                       <div id="error_detalle" style="text-align:center">El producto ya existe en la lista </div>
                <table id="list" >



                </table>   
        		</div>    			
        </div>
     		<div style="text-align:center" ><%= f.submit 'Guardar', :class=>"btn btn-danger" %> </div>

     	<% end %>
		
     	</div>


     </div>
 </div>

 
<script type="text/javascript">

  $(document).ready(function () {

 });

  

  //INICIO AUTOCOMPLETAR.....
     $('#producto').autocomplete('<%= todos_productos_path %>', {
         dataType: "json",
       parse: function(data) {
         return $.map(data, function(row) {
           return {
             data: row.producto,
             value: $.trim(row.producto.nombre),
             result: $.trim(row.producto.nombre)
           }
         });
       },
       formatItem: function(item) {
           return item.codigo+"-"+item.nombre;
       }
      }).result(function(e, item) {
        $("#producto_id").val(item.id);
      });
     //FIN AUTOCOMPLETAR.....


  function agregar(cantidad){
      $('#agrega').val(cantidad);
      agregar_ajax();
  } 

  function agregar_ajax(){
    
    jQuery.ajax({
           type:'get',
           //url:'<%= agregar_detalle_pedido_compras_path %>?nomenclador_id='+ $('#nomenclador_id').val() +'&codigo_practica='+$('#codigo_practica_id').val()+'&beneficiario_id='+$('#beneficiario_id').val()+'&diagnostico_id='+$('#diagnostico_id').val()+'&fecha_prescripcion='+$('#fecha_prescripcion').val()+'&b_p_id='+$('input[name=plan_especial]:checked').val()
           url:'<%= agregar_detalle_pedido_compras_path %>?proveedor_id='+ $('#proveedor_id').val()+ '&agrega='+ $('#agrega').val() + '&producto_id='+ $('#producto_id').val() 
           });

   };


  function agregar_detalle(filas) {
       filas.forEach(function(fila){
             $('#list').append(
                  "<tr id='detalle"+fila[0]+"'>" +
                  "<td>"+ fila[1] +"</td>"+
                  "<td>"+ fila[2] +"</td>"  
             );
        });
  } 




     function agregar_fila(id) {//,codigo,producto,unidad,stock,cant_pedida){
         alert('agrega         fila sola ' + id);
         

     };

     function eliminar_fila(id){
      alert ("entro elliminar " + id)
          $('#fila'+id).remove();
     }


     function elimina_detalle(){
      alert ("ento elliinr " )
          $('#list tr').remove();
     }
 
</script>



<style type="text/css">

    .datos{
      display: inline-block;
      text-align: right;
      height: 34px;
      background-color: #4478aa;  
    }


  	.datos label{
  		padding: 0 6px;
      font-size: 11px 
  	}

    .datos input{
      display: inline;
      font-size: 11px 
    }


  	#comprobante{
  		background-color: green;
  		height:450px;
  		padding: px;
  		border-width: 1px;
  		border-color: red;
  	}


    #busca_productos {
      margin-top: 6px;
      border: 1px solid #FFFAAA;
      padding: 4px;
    } 


    #cabezera {
      border: 1px solid #FFFAAA;
      padding: 8px;
    } 
    


    #detalle{
      margin-top: 6px;
      border: 1px solid #123FAF;
      width: 100%;
      height: 300px;
      padding: 10px
    }


    #titulo{
      margin: 40px 0 4px 0;
    }

    #buscador{
        height: 35px;
        margin-bottom: 10px
    }

    #menu_izquierdo{
      float: left;
      padding:20px 0 0 18px;
      /* background-color:green; */
    }

    #contenido{
      padding:10px 30px 0 40px;
      /*background-color:white; */
      float: left;
      display: inline;
    }

    .textbox_buscar{
      float:right;
      height: 20px
    }

</style>


  